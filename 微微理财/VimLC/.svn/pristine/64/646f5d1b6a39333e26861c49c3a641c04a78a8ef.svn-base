//
//  MSUTradeBottomView.m
//  VimLC
//
//  Created by 007 on 2018/1/15.
//  Copyright © 2018年 HM. All rights reserved.
//

#import "MSUTradeBottomView.h"

#import "MSUTradeBottomTableCell.h"

#import "MSUPathTools.h"
#import "MSUStringTools.h"

@interface MSUTradeBottomView()<UITableViewDelegate,UITableViewDataSource>

@property (nonatomic , strong) UITableView *tableView;

@property (nonatomic , strong) NSArray *imaArr;
@property (nonatomic , strong) NSArray *titArr;

@end

@implementation MSUTradeBottomView

- (instancetype)initWithFrame:(CGRect)frame
{
    if (self = [super initWithFrame:frame]) {
        
        [self createView];
        self.imaArr = @[@"sysj_icon",@"qtje_icon",@"hkfs_icon",@"jxfs_icon"];
        self.titArr = @[@"剩余时间",@"起投金额",@"还款方式",@"计息方式"];
        
    }
    return self;
}

- (void)setDataArr:(NSArray *)dataArr{
    _dataArr = dataArr;
    [_tableView reloadData];
}

- (void)createView{
    self.tableView = [[UITableView alloc] initWithFrame:CGRectMake(0, 0, kDeviceWidth, (50.5*4+35)*kDeviceHeightScale) style:UITableViewStylePlain];
    _tableView.backgroundColor = BGWhiteColor;
    _tableView.scrollEnabled = NO;
    _tableView.separatorStyle = UITableViewCellSeparatorStyleNone;
    _tableView.showsVerticalScrollIndicator = NO;
    [self addSubview:_tableView];
    self.tableView.delegate = self;
    self.tableView.dataSource = self;
    self.tableView.panGestureRecognizer.delaysTouchesBegan = self.tableView.delaysContentTouches;
    _tableView.rowHeight = 50.5*kDeviceHeightScale;
    [_tableView registerClass:[MSUTradeBottomTableCell class] forCellReuseIdentifier:@"MSUTradeBottomTableCell"];
    if (iOS11) {
        _tableView.contentInsetAdjustmentBehavior = UIScrollViewContentInsetAdjustmentNever;
    }
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{
    return 4;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
    MSUTradeBottomTableCell *cell = [tableView dequeueReusableCellWithIdentifier:@"MSUTradeBottomTableCell"];
    cell.selectionStyle = UITableViewCellSelectionStyleNone;
    
    cell.leftImaView.image = [MSUPathTools showImageWithContentOfFileByName:_imaArr[indexPath.row]];
    cell.leftLab.text = _titArr[indexPath.row];
    cell.rightLab.text = _dataArr[indexPath.row];

    if (_dataArr.count > 0) {
        if (indexPath.row == 0) {
            cell.rightLab.textColor = titBlackColor;
            cell.rightLab.attributedText = [MSUStringTools makeKeyWordAttributedWithSubText:@"天" textA:@"分" textB:@"时" textC:@"" inOrigiText:_dataArr[0] font:14 color:titQianColor];
            
        } else if (indexPath.row == 1) {
            NSString *str = [NSString stringWithFormat:@"%ld元",[_dataArr[1] integerValue]];
            cell.rightLab.attributedText = [MSUStringTools makeKeyWordAttributedWithSubText:str inOrigiText:[NSString stringWithFormat:@"%ld元起投",[_dataArr[1] integerValue]] font:14 color:titOrangeColor];
        }
    }
    
    
    return cell;
}

- (UIView *)tableView:(UITableView *)tableView viewForFooterInSection:(NSInteger)section{
    UIView *bgView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, kDeviceWidth, 35*kDeviceHeightScale)];
    bgView.backgroundColor = HEXCOLOR(0xf2f8ff);

    UIButton *moreBtn= [UIButton buttonWithType:UIButtonTypeCustom];
    moreBtn.frame = CGRectMake(kDeviceWidth*0.5-42*kDeviceWidthScale, 7.5, 84*kDeviceWidthScale, 20*kDeviceWidthScale);
    [moreBtn setTitle:@"更多项目信息" forState:UIControlStateNormal];
    [moreBtn setTitleColor:HEXCOLOR(0x659fee) forState:UIControlStateNormal];
    moreBtn.titleLabel.font = [UIFont systemFontOfSize:14];
    [bgView addSubview:moreBtn];
    [moreBtn addTarget:self action:@selector(moreBtnClick:) forControlEvents:UIControlEventTouchUpInside];
    
    
    UIImageView *imaView = [[UIImageView alloc] initWithFrame:CGRectMake(moreBtn.left - 18*kDeviceWidthScale, 11.5*kDeviceHeightScale, 13*kDeviceHeightScale, 17*kDeviceHeightScale)];
    imaView.image = [MSUPathTools showImageWithContentOfFileByName:@"gdxm_icon"];
    imaView.contentMode =UIViewContentModeScaleAspectFit;;
    [bgView addSubview:imaView];
    
    
    return bgView;
}

- (CGFloat)tableView:(UITableView *)tableView heightForFooterInSection:(NSInteger)section{
    return 35*kDeviceHeightScale;
}

- (void)moreBtnClick:(UIButton *)sender{
    if (self.moreBtnClickBlock) {
        self.moreBtnClickBlock(sender);
    }
}


@end
