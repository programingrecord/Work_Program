//
//  HomeNewTableViewCell.m
//  VimLC
//
//  Created by 慧明 on 2017/11/6.
//  Copyright © 2017年 HM. All rights reserved.
//

#import "HomeNewTableViewCell.h"

@implementation HomeNewTableViewCell

- (void)awakeFromNib {
    [super awakeFromNib];
    CAGradientLayer *gradientLayer = [[CAGradientLayer alloc] init];
    gradientLayer.colors = @[(__bridge id)[UIColor colorWithHex:0xFD9C68].CGColor,(__bridge id)[UIColor colorWithHex:0xFB6337].CGColor];

    gradientLayer.startPoint = CGPointMake(0, 1);
    
    gradientLayer.endPoint = CGPointMake(1, 1);
    
    gradientLayer.frame = CGRectMake(0, 0, kDeviceWidth-80, CGRectGetHeight(self.LoanButton.frame));
    [self.LoanButton.layer insertSublayer:gradientLayer atIndex:0];
    
    [self.contentView addSubview:self.HYView];
    self.HYView.hidden = YES;

    self.HYView.progressTipLabel.text = @"预期年化收益";
}

- (HYCircleProgressView *)HYView{
    if (!_HYView) {
        float height = kDeviceHeight-29-330 *kDeviceHeightScale-110;
        float space = 30;
        if (IS_IPHONE_5) {
            space = 15;
        }
        _HYView =[[HYCircleProgressView alloc]initWithFrame:CGRectMake((kDeviceWidth- height)/2, self.TitleLabel.bottom +space, height, height)];
        [_HYView setBackgroundStrokeColor:[UIColor colorWithHex:0xededed]];
        [_HYView setProgressStrokeColor:[UIColor colorWithHex:0xf5a623]];
        [_HYView setProgress:0 animated:YES];
        [_HYView setDigitTintColor:[UIColor colorWithHex:0xFF6339]];
        [_HYView setProgressTipTintColor:[UIColor colorWithHex:0x666666]];
    }
    return _HYView;
}
- (void)setModel:(loanModel *)model{
    if (_model != model) {
        _model =model;
    }
    self.Tip1Label.text = _model.currentTip1;
    self.Tip2Label.text = _model.currentTip2;
    self.Tip3Label.text = _model.currentTip3;
    self.TitleLabel.text = _model.borrowTypeOther;

    if ([_model.borrowTypeOther isEqualToString:@"米粒宝"]) {
        self.ImageTip.image = [UIImage imageNamed:@"icon_home_xinshouyouli"];
        self.HYView.hidden = YES;
        self.MLBRateLabel.hidden= NO;
        self.MLBTipLabel.hidden = NO;
        self.TitleLabel.hidden = NO;
        self.BGView.hidden = YES;
        self.TitleLeftImage.hidden = NO;
        self.TitleRightImage.hidden = NO;
        self.ButtonSpace.constant = 20;
        
//        NSString *Str1 = [NSString stringWithFormat:@"%@%%+%@%%",_model.rate1,_model.rate2];
//        NSString *Str2 =[NSString stringWithFormat:@"%@",_model.rate1];
        float  font1 = 24;
        float  font2 = 45;

        if (IS_IPHONE_5) {
            font1 = 12;
            font2 = 24;
        }
//        NSRange range1= [Str1 rangeOfString:Str2];
//        NSMutableAttributedString *Astring1 = [[NSMutableAttributedString alloc] initWithString:Str1];
//        [Astring1 addAttribute:NSFontAttributeName value:[UIFont systemFontOfSize:font1] range:NSMakeRange(0, Str1.length)];
//        [Astring1 addAttribute:NSFontAttributeName value:[UIFont systemFontOfSize:font2] range:range1];
//        self.MLBRateLabel.attributedText =Astring1;

        
        
        NSString *Str =[NSString stringWithFormat:@"%@%%",_model.rate];
        NSMutableAttributedString *Astring1 = [[NSMutableAttributedString alloc] initWithString:Str];
        [Astring1 addAttribute:NSFontAttributeName value:[UIFont systemFontOfSize:font1] range:NSMakeRange(0, Str.length)];
        [Astring1 addAttribute:NSFontAttributeName value:[UIFont systemFontOfSize:font2] range:NSMakeRange(0, Str.length-1)];
        self.MLBRateLabel.attributedText =Astring1;
        self.Tip1Label.text = _model.currentTip1;
        self.Tip2Label.text = _model.currentTip2;
        self.Tip3Label.text = _model.currentTip3;
    }else{
        if ([_model.borrowTypeOther isEqualToString:@"新手标"]) {
            self.TitleLabel.text = @"新手专享";
        }
        NSString *hasActivity = [NSString stringWithFormat:@"%@",_model.hasActivity];
        if ([hasActivity isEqualToString:@"1"]) {
            self.ImageTip.image = [UIImage imageNamed:@"one_tip_Image"];
            self.TitleLabel.hidden = YES;
            self.BGView.hidden = NO;
            self.TitleLeftImage.hidden = YES;
            self.TitleRightImage.hidden = YES;
        }else{
            self.ImageTip.image = [UIImage imageNamed:@"icon_home_new"];
            self.TitleLabel.hidden = NO;
            self.BGView.hidden = YES;
            self.TitleLeftImage.hidden = NO;
            self.TitleRightImage.hidden = NO;
            
        }
        
        
        self.HYView.hidden = NO;
        self.MLBRateLabel.hidden= YES;
        self.MLBTipLabel.hidden = YES;
        NSString *Str1 = [NSString stringWithFormat:@"%@%%+%@%%",_model.rate1,_model.rate2];
        NSString *Str2 =[NSString stringWithFormat:@"%@",_model.rate1];
        
        float  font1 = 24;
        float  font2 = 45;
        
        if (IS_IPHONE_5) {
            font1 = 15;
            font2 = 30;
        }
        
        NSRange range1= [Str1 rangeOfString:Str2];
        NSMutableAttributedString *Astring1 = [[NSMutableAttributedString alloc] initWithString:Str1];
        [Astring1 addAttribute:NSFontAttributeName value:[UIFont systemFontOfSize:font1] range:NSMakeRange(0, Str1.length)];
        [Astring1 addAttribute:NSFontAttributeName value:[UIFont systemFontOfSize:font2] range:range1];
        
        self.HYView.progressLabel.attributedText =Astring1;
        float completePercent = [_model.completePercent floatValue]/100;
        [self.HYView setProgress:completePercent animated:YES];
    }
}
- (void)setSelected:(BOOL)selected animated:(BOOL)animated {
    [super setSelected:selected animated:animated];

    // Configure the view for the selected state
}

- (IBAction)ButtonClick:(id)sender {
    
    if (self.block) {
        self.block();
    }
}

@end
